name: ci

on:
  push:
    branches:
      - main
      - 4-add-unit-test-to-sample-app

# jobs:
#   security:
#     runs-on: ubuntu-latest
#     steps:
#       - uses: actions/checkout@master
#       - name: Run Snyk to check for vulnerabilities
#         uses: snyk/actions/node@master
#         continue-on-error: true # To make sure that SARIF upload gets called
#         env:
#           SNYK_TOKEN: ${{ secrets.SNYK_TOKEN }}
      # TODO stretch goal - enable time permitting
      #   with:
      #     args: --sarif-file-output=snyk.sarif
      # - name: Upload result to GitHub Code Scanning
      #   uses: github/codeql-action/upload-sarif@v2
      #   with:
      #     sarif_file: snyk.sarif
  build:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        node-version: [18.x]
    steps:
      - uses: actions/checkout@v3
      - name: Use NodeJS version ${{ matrix.node-version}}
        uses: actions/setup-node@v3
        with:
          node-version: ${{ matrix.node-version}}
      - run: npm ci
      - run: npm run build --if-present
      - run: npm test